<div class="comments-section-custom" style="background: #fafafa; border-radius: 18px; padding: 24px;">
    <h2 class="comments-header"
        style="color: #a55c8f; font-family: 'Lobster', cursive; font-weight: bold; margin-bottom: 24px;">Comments:</h2>
    {% if not user.is_authenticated %}
    <a href="{% url 'add_comment_to_post' pk=post.pk %}" class="add-comment-btn">Add comment</a>
    {% endif %}
    {% for comment in post.comments.all %}
    {% if not comment.parent %}
    {% if user.is_authenticated or comment.approved_comment %}
    <div class="comment-card"
        style="display: flex; align-items: flex-start; background: #fff; border-radius: 16px; margin-bottom: 18px; box-shadow: 0 2px 8px rgba(207,109,150,0.07); padding: 18px 20px;">
        <!-- Author Initial Circle -->
        <div
            style="width: 48px; height: 48px; border-radius: 50%; background: #f8c3da; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: bold; color: #000000; margin-right: 18px;">
            {{ comment.author|slice:":1"|upper }}
        </div>
        <!-- Comment Meta and Text -->
        <div style="flex: 1;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <span style="font-weight: 500; color: #a55c8f;">From: <span
                            style="font-weight: bold; color: #222;">{{ comment.author }}</span></span><br>
                    <span class="comment-date" style="font-size: 15px; color: #888;">{{ comment.created_date|date:"M d, Y, g:i a" }}</span>
                </div>
                <div>
                    {% if user.is_authenticated %}
                    {% if comment.approved_comment %}
                    <!-- Approved: show only delete button -->
                    <button type="button" class="btn btn-sm btn-outline-danger js-comment-action" data-method="POST"
                        data-url="{% url 'comment_remove' pk=comment.pk %}" title="Delete"
                        style="border:none;background:none;padding:0;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#a55c8f"
                            viewBox="0 0 16 16">
                            <path
                                d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5.5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6zm3 .5a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6z" />
                            <path fill-rule="evenodd"
                                d="M14.5 3a1 1 0 0 1-1-1V1a1 1 0 0 0-1-1h-7a1 1 0 0 0-1-1v1a1 1 0 0 1-1 1H1v1h14V3h-1.5zm-1-1V1h-7v1h7zM2.5 4v9a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V4h-11zm11 9a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V4h9v9z" />
                        </svg>
                    </button>
                    {% else %}
                    <!-- Approve button -->
                    <button type="button" class="btn btn-sm btn-outline-success js-comment-action" data-method="POST"
                        data-url="{% url 'comment_approve' pk=comment.pk %}" title="Approve"
                        style="border:none;background:none;padding:0;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#38c172"
                            viewBox="0 0 16 16">
                            <path
                                d="M13.485 1.929a.75.75 0 0 1 0 1.06l-7.07 7.07a.75.75 0 0 1-1.06 0l-3.182-3.182a.75.75 0 1 1 1.06-1.06l2.652 2.652 6.54-6.54a.75.75 0 0 1 1.06 0z" />
                        </svg>
                    </button>
                    <!-- Disapprove button -->
                    <button type="button" class="btn btn-sm btn-outline-danger js-comment-action" data-method="POST"
                        data-url="{% url 'comment_remove' pk=comment.pk %}" title="Disapprove"
                        style="border:none;background:none;padding:0;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#a55c8f"
                            viewBox="0 0 16 16">
                            <path
                                d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5.5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6zm3 .5a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6z" />
                            <path fill-rule="evenodd"
                                d="M14.5 3a1 1 0 0 1-1-1V1a1 1 0 0 0-1-1h-7a1 1 0 0 0-1-1v1a1 1 0 0 1-1 1H1v1h14V3h-1.5zm-1-1V1h-7v1h7zM2.5 4v9a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V4h-11zm11 9a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V4h9v9z" />
                        </svg>
                    </button>
                    {% endif %}
                    {% endif %}
                </div>
            </div>
            <div class="comment-text" style="margin-top: 10px; font-size: 17px; color: #222;">{{ comment.text }}</div>
        </div>
    </div>
    {% endif %}
    {% endif %}
    {% empty %}
    <p>No comments yet.</p>
    {% endfor %}
</div>